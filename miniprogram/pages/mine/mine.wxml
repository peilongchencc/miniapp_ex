<!--mine.wxml-->
<view class="mine-container">
  <!-- 用户信息区域 -->
  <view class="user-header">
    <!-- 未登录状态 -->
    <block wx:if="{{!isLoggedIn}}">
      <view class="avatar-wrapper">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="cover"></image>
      </view>
      <view class="login-section">
        <view class="login-btn" bindtap="handleLogin">登录/注册</view>
        <text class="login-tip">登录后享受更多服务</text>
      </view>
    </block>

    <!-- 已登录状态 -->
    <block wx:else>
      <view class="avatar-wrapper">
        <image class="avatar" src="{{userInfo.avatarUrl}}" mode="cover"></image>
        <button class="avatar-overlay" open-type="chooseAvatar" hover-class="none" bind:chooseavatar="onChooseAvatar"></button>
      </view>
      <view class="user-info-right">
        <input type="nickname" class="nickname-input-hidden" value="{{userInfo.nickName}}" bind:change="onInputChange" />
        <text class="nickname">{{userInfo.nickName}}</text>
        <text class="edit-tip">点击头像或昵称可修改</text>
      </view>
    </block>
  </view>

  <!-- 常用功能区域 -->
  <view class="common-functions">
    <view class="section-title">常用功能</view>
    <view class="function-grid">
      <view class="function-item" bindtap="contactShop">
        <image class="function-icon" src="/images/contact-icon.png" mode="aspectFit"></image>
        <text class="function-text">联系客服</text>
      </view>
      <view class="function-item" bindtap="goToOrders">
        <image class="function-icon" src="/images/orders-icon.png" mode="aspectFit"></image>
        <text class="function-text">我的订单</text>
      </view>
      <view class="function-item" bindtap="goToAddress">
        <image class="function-icon" src="/images/address-icon.png" mode="aspectFit"></image>
        <text class="function-text">我的地址</text>
      </view>
    </view>
  </view>

  <!-- 退出登录按钮 (仅登录后显示) -->
  <view wx:if="{{isLoggedIn}}" class="logout-section">
    <view class="logout-btn" bindtap="handleLogout">退出登录</view>
  </view>
</view>
