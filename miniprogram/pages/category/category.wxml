<!--category.wxml-->
<view class="container" style="padding-top: {{navPlaceholderHeight}}px;">
  <!-- 自定义导航栏 -->
  <view class="custom-navbar" style="padding-top: {{statusBarHeight}}px;">
    <view class="navbar-content" style="height: {{menuButtonHeight}}px; margin-top: {{menuButtonTop - statusBarHeight}}px; padding-right: {{menuButtonRight + menuButtonWidth + 16}}px;">
      <!-- 搜索框 -->
      <view class="search-box">
        <image class="search-icon" src="/images/search-icon.png" mode="aspectFit"></image>
        <input 
          class="search-input" 
          type="text" 
          placeholder="搜索商品名称" 
          value="{{searchKeyword}}"
          bindinput="onSearchInput"
          bindconfirm="onSearchConfirm"
        />
        <view wx:if="{{searchKeyword}}" class="clear-icon" bindtap="onClearSearch">×</view>
      </view>
    </view>
  </view>
  
  <view class="content">
    <!-- 左侧分类列表 -->
    <scroll-view class="category-list" scroll-y>
      <view 
        wx:for="{{categories}}" 
        wx:key="id"
        class="category-item {{currentCategoryId === item.id ? 'active' : ''}}"
        data-id="{{item.id}}"
        bindtap="onCategoryTap"
      >
        {{item.name}}
      </view>
    </scroll-view>
    
    <!-- 右侧商品列表（按二级分类分组） -->
    <scroll-view class="product-list" scroll-y>
      <!-- 搜索模式提示 -->
      <view wx:if="{{isSearchMode}}" class="search-result-tip">
        搜索结果: "{{searchKeyword}}"
      </view>
      
      <!-- 按二级分类分组展示 -->
      <view wx:for="{{groupedProducts}}" wx:key="id" class="sub-category-section">
        <!-- 二级分类标题 -->
        <view class="sub-category-header">
          <view class="sub-category-line"></view>
          <text class="sub-category-name">{{item.subCategory.name}}</text>
          <view class="sub-category-line"></view>
        </view>
        
        <!-- 该二级分类下的商品 -->
        <view class="product-grid">
          <view 
            wx:for="{{item.products}}" 
            wx:for-item="product"
            wx:key="id"
            class="product-item"
            data-id="{{product.id}}"
            data-name="{{product.name}}"
            data-image="{{product.image}}"
            data-base-price="{{product.basePrice}}"
            bindtap="onProductTap"
          >
            <image class="product-image" src="{{product.image}}" mode="aspectFill"></image>
            <text class="product-name">{{product.name}}</text>
            <text class="product-price">¥{{product.basePrice}}</text>
          </view>
        </view>
      </view>
      
      <!-- 空状态 -->
      <view wx:if="{{groupedProducts.length === 0}}" class="empty-state">
        <text>暂无商品</text>
      </view>
    </scroll-view>
  </view>
</view>
